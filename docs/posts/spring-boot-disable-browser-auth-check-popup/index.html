<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Spring Boot] 브라우저 인증체크 팝업 비활성화</title>
    <meta name="description" content="I am writing about my experiences as a naval navel-gazer.">
    <link rel="stylesheet" href="/techblog/css/index.css">
    <link rel="stylesheet" href="/techblog/css/prism-base16-monokai.dark.css">
  </head>
  <body>
    <header>
      <h1 class="home"><a href="/techblog/">my techblog</a></h1>
      <ul class="nav">
        <li class="nav-item"><a href="/techblog/">Home</a></li>
        <li class="nav-item"><a href="/techblog/posts/">Archive</a></li>
        <li class="nav-item"><a href="/techblog/about/">About Me</a></li>
      </ul>
    </header>

    <main class="tmpl-post">
      <h1>[Spring Boot] 브라우저 인증체크 팝업 비활성화</h1>

<time datetime="2021-09-02">02 Sep 2021</time><a href="/techblog/tags/spring-boot/" class="post-tag">Spring Boot</a><a href="/techblog/tags/spring-security/" class="post-tag">Spring Security</a>

<h2 id="%EC%9A%A9%EB%8F%84">용도 <a class="direct-link" href="#%EC%9A%A9%EB%8F%84">#</a></h2>
<p>스프링 시큐리티 사용시, 인증 크롬 팝업을 비활성화하여 바로 401(Unauthorized)에러를 띄우고 싶을 때</p>
<h2 id="code">code <a class="direct-link" href="#code">#</a></h2>
<pre class="language-java"><code class="language-java"><span class="token comment">// CustomizedAuthenticationEntryPointConfig.java</span><br><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">AuthenticationException</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>web<span class="token punctuation">.</span></span><span class="token class-name">AuthenticationEntryPoint</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * (크롬) 인증팝업 비활성화 처리<br> *<br> */</span><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomizedAuthenticationEntryPointConfig</span> <span class="token keyword">implements</span> <span class="token class-name">AuthenticationEntryPoint</span> <span class="token punctuation">{</span><br>    <span class="token annotation punctuation">@Override</span><br>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">commence</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span><br>            <span class="token class-name">AuthenticationException</span> authException<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span><br>        response<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span>SC_UNAUTHORIZED<span class="token punctuation">,</span> authException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<pre class="language-java"><code class="language-java"><span class="token comment">// WebSecurityConfig.java</span><br><span class="token comment">// (org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter를 상속받은 설정 클래스)</span><br><span class="token annotation punctuation">@Configuration</span><br><span class="token annotation punctuation">@EnableWebSecurity</span><br><span class="token annotation punctuation">@Order</span><span class="token punctuation">(</span><span class="token class-name">SecurityProperties</span><span class="token punctuation">.</span>BASIC_AUTH_ORDER<span class="token punctuation">)</span><br><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthorizationServerConfig</span> <span class="token keyword">extends</span> <span class="token class-name">AuthorizationServerConfigurerAdapter</span> <span class="token punctuation">{</span><br>    <span class="token comment">// ..</span><br>    <span class="token annotation punctuation">@Override</span><br>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span><br>        <span class="token comment">// 다른 중간 설정은 참고만</span><br>        http<br>        <span class="token comment">// .csrf().disable().headers().frameOptions().disable().and().authorizeRequests()</span><br>        <span class="token comment">//         .requestMatchers(CorsUtils::isPreFlightRequest).permitAll()</span><br>        <span class="token comment">//         .antMatchers(HttpMethod.OPTIONS).permitAll()</span><br>                <span class="token comment">// .antMatchers("/**").permitAll()</span><br>                <span class="token comment">// .antMatchers("/").permitAll()</span><br>                <span class="token comment">// .anyRequest().authenticated() //</span><br>                <span class="token comment">// .and()</span><br>                <span class="token punctuation">.</span><span class="token function">httpBasic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">authenticationEntryPoint</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CustomizedAuthenticationEntryPointConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//&lt;-- new 방식이던 @Component 로 등록 후 @Autowired로 하던 될 거로 보임</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>

<hr>
<ul><li>Next: <a href="/techblog/posts/006-vue-router-cache-manage/">[Vue Router] vue router 캐시 관리</a></li><li>Previous: <a href="/techblog/posts/maintain-example-feat-typescript/">feat.typescript</a></li>
</ul>

    </main>

    <footer></footer>

    <!-- Current page: /techblog/posts/spring-boot-disable-browser-auth-check-popup/ -->
  </body>
</html>
